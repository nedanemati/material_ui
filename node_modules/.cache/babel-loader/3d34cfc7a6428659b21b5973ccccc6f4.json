{"ast":null,"code":"var tokenize = require('../tokenizer');\n\nvar TokenStream = require('../common/TokenStream');\n\nvar tokenStream = new TokenStream();\nvar astToTokens = {\n  decorator: function (handlers) {\n    var curNode = null;\n    var prev = {\n      len: 0,\n      node: null\n    };\n    var nodes = [prev];\n    var buffer = '';\n    return {\n      children: handlers.children,\n      node: function (node) {\n        var tmp = curNode;\n        curNode = node;\n        handlers.node.call(this, node);\n        curNode = tmp;\n      },\n      chunk: function (chunk) {\n        buffer += chunk;\n\n        if (prev.node !== curNode) {\n          nodes.push({\n            len: chunk.length,\n            node: curNode\n          });\n        } else {\n          prev.len += chunk.length;\n        }\n      },\n      result: function () {\n        return prepareTokens(buffer, nodes);\n      }\n    };\n  }\n};\n\nfunction prepareTokens(str, nodes) {\n  var tokens = [];\n  var nodesOffset = 0;\n  var nodesIndex = 0;\n  var currentNode = nodes ? nodes[nodesIndex].node : null;\n  tokenize(str, tokenStream);\n\n  while (!tokenStream.eof) {\n    if (nodes) {\n      while (nodesIndex < nodes.length && nodesOffset + nodes[nodesIndex].len <= tokenStream.tokenStart) {\n        nodesOffset += nodes[nodesIndex++].len;\n        currentNode = nodes[nodesIndex].node;\n      }\n    }\n\n    tokens.push({\n      type: tokenStream.tokenType,\n      value: tokenStream.getTokenValue(),\n      index: tokenStream.tokenIndex,\n      // TODO: remove it, temporary solution\n      balance: tokenStream.balance[tokenStream.tokenIndex],\n      // TODO: remove it, temporary solution\n      node: currentNode\n    });\n    tokenStream.next(); // console.log({ ...tokens[tokens.length - 1], node: undefined });\n  }\n\n  return tokens;\n}\n\nmodule.exports = function (value, syntax) {\n  if (typeof value === 'string') {\n    return prepareTokens(value, null);\n  }\n\n  return syntax.generate(value, astToTokens);\n};","map":{"version":3,"names":["tokenize","require","TokenStream","tokenStream","astToTokens","decorator","handlers","curNode","prev","len","node","nodes","buffer","children","tmp","call","chunk","push","length","result","prepareTokens","str","tokens","nodesOffset","nodesIndex","currentNode","eof","tokenStart","type","tokenType","value","getTokenValue","index","tokenIndex","balance","next","module","exports","syntax","generate"],"sources":["/Users/nedanemati/Desktop/material-ui-github/node_modules/css-tree/lib/lexer/prepare-tokens.js"],"sourcesContent":["var tokenize = require('../tokenizer');\nvar TokenStream = require('../common/TokenStream');\nvar tokenStream = new TokenStream();\nvar astToTokens = {\n    decorator: function(handlers) {\n        var curNode = null;\n        var prev = { len: 0, node: null };\n        var nodes = [prev];\n        var buffer = '';\n\n        return {\n            children: handlers.children,\n            node: function(node) {\n                var tmp = curNode;\n                curNode = node;\n                handlers.node.call(this, node);\n                curNode = tmp;\n            },\n            chunk: function(chunk) {\n                buffer += chunk;\n                if (prev.node !== curNode) {\n                    nodes.push({\n                        len: chunk.length,\n                        node: curNode\n                    });\n                } else {\n                    prev.len += chunk.length;\n                }\n            },\n            result: function() {\n                return prepareTokens(buffer, nodes);\n            }\n        };\n    }\n};\n\nfunction prepareTokens(str, nodes) {\n    var tokens = [];\n    var nodesOffset = 0;\n    var nodesIndex = 0;\n    var currentNode = nodes ? nodes[nodesIndex].node : null;\n\n    tokenize(str, tokenStream);\n\n    while (!tokenStream.eof) {\n        if (nodes) {\n            while (nodesIndex < nodes.length && nodesOffset + nodes[nodesIndex].len <= tokenStream.tokenStart) {\n                nodesOffset += nodes[nodesIndex++].len;\n                currentNode = nodes[nodesIndex].node;\n            }\n        }\n\n        tokens.push({\n            type: tokenStream.tokenType,\n            value: tokenStream.getTokenValue(),\n            index: tokenStream.tokenIndex, // TODO: remove it, temporary solution\n            balance: tokenStream.balance[tokenStream.tokenIndex], // TODO: remove it, temporary solution\n            node: currentNode\n        });\n        tokenStream.next();\n        // console.log({ ...tokens[tokens.length - 1], node: undefined });\n    }\n\n    return tokens;\n}\n\nmodule.exports = function(value, syntax) {\n    if (typeof value === 'string') {\n        return prepareTokens(value, null);\n    }\n\n    return syntax.generate(value, astToTokens);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}